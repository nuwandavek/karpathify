Aleksei Bochkovskii&Amaël Delaunoy&Hugo Germain&Marcel Santos\\ANDYichao Zhou&Stephan R. Richter  
Apple&Vladlen Koltun

###### Abstract

We present a foundation model for zero-shot metric monocular depth estimation. Our model, Depth Pro, synthesizes high-resolution depth maps with unparalleled sharpness and high-frequency details. The predictions are metric, with absolute scale, without relying on the availability of metadata such as camera intrinsics. And the model is fast, producing a 2.25-megapixel depth map in 0.3 seconds on a standard GPU. These characteristics are enabled by a number of technical contributions, including an efficient multi-scale vision transformer for dense prediction, a training protocol that combines real and synthetic datasets to achieve high metric accuracy alongside fine boundary tracing, dedicated evaluation metrics for boundary accuracy in estimated depth maps, and state-of-the-art focal length estimation from a single image. Extensive experiments analyze specific design choices and demonstrate that Depth Pro outperforms prior work along multiple dimensions. We release code & weights at [https://github.com/apple/ml-depth-pro](https://github.com/apple/ml-depth-pro)

## 1 Introduction

Figure 1: Results on images from the AM-2k (Li et al., [2022a](https://arxiv.org/html/2410.02073v1#bib.bib56)) (1st & 3rd column) and DIS-5k (Qin et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib77)) (2nd column) datasets. Input image on top, estimated depth maps from Depth Pro, Marigold (Ke et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib45)), Depth Anything v2 (Yang et al., [2024b](https://arxiv.org/html/2410.02073v1#bib.bib113)), and Metric3D v2 (Hu et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib38)) below. Depth Pro produces zero-shot metric depth maps with absolute scale at 2.25-megapixel native resolution in 0.3 seconds on a V100 GPU.

Zero-shot monocular depth estimation underpins a growing variety of applications, such as advanced image editing, view synthesis, and conditional image generation. Inspired by MiDaS (Ranftl et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib83)) and many follow-up works (Ranftl et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib82); Ke et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib45); Yang et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib112); Piccinelli et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib76); Hu et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib38)), applications increasingly leverage the ability to derive a dense pixelwise depth map for any image.

Our work is motivated in particular by novel view synthesis from a single image, an exciting application that has been transformed by advances in monocular depth estimation (Hedman et al., [2017](https://arxiv.org/html/2410.02073v1#bib.bib37); Shih et al., [2020](https://arxiv.org/html/2410.02073v1#bib.bib90); Jampani et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib43); Khan et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib46)). Applications such as view synthesis imply a number of desiderata for monocular depth estimation. First, the depth estimator should work zero-shot on any image, not restricted to a specific domain (Ranftl et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib83); Yang et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib112)). Furthermore, the method should ideally produce _metric_ depth maps in this zero-shot regime, to accurately reproduce object shapes, scene layouts, and absolute scales (Guizilini et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib35); Hu et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib38)). For the broadest applicability ‘in the wild’, the method should produce metric depth maps with absolute scale even if no camera intrinsics (such as focal length) are provided with the image (Piccinelli et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib76)). This enables view synthesis scenarios such as “Synthesize a view of this scene from 63 mm away” for essentially arbitrary single images (Dodgson, [2004](https://arxiv.org/html/2410.02073v1#bib.bib21)).

Second, for the most compelling results, the monocular depth estimator should operate at high resolution and produce fine-grained depth maps that closely adhere to image details such as hair, fur, and other fine structures (Miangoleh et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib70); Ke et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib45); Li et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib61)). One benefit of producing sharp depth maps that accurately trace intricate details is the elimination of “flying pixels”, which can degrade image quality in applications such as view synthesis (Jampani et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib43)).

Third, for many interactive application scenarios, the depth estimator should operate at low latency, processing a high-resolution image in less than a second to support interactive view synthesis “queries” on demand. Low latency is a common characteristic of methods that reduce zero-shot monocular depth estimation to a single forward pass through a neural network (Ranftl et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib82); Yang et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib112); Piccinelli et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib76)),   but it is not always shared by methods that employ more computationally demanding machinery at test time (Ke et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib45); Li et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib61)).

![Refer to caption](chrome-extension://pcmpcfapbekmbjjkdalcgopdkipoggdi/html/2410.02073v1/x1.png)

![Refer to caption](chrome-extension://pcmpcfapbekmbjjkdalcgopdkipoggdi/html/2410.02073v1/x2.png)

Figure 2: Boundary recall versus runtime. Depth Pro outperforms prior work by a multiplicative factor in boundary accuracy while being orders of magnitude faster than works focusing on fine-grained predictions (e.g., Marigold, PatchFusion).

In this work, we present a foundation model for zero-shot metric monocular depth estimation that meets all of these desiderata. Our model, Depth Pro, produces metric depth maps with absolute scale on arbitrary images ‘in the wild’ without requiring metadata such as camera intrinsics. It operates at high resolution, producing 2.25-megapixel depth maps (with a native output resolution of 1536×1536153615361536\\times 15361536 × 1536 before optional further upsampling) in 0.3 seconds on a V100 GPU. Fig. [1](https://arxiv.org/html/2410.02073v1#S1.F1 "Figure 1 ‣ 1 Introduction ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") shows some representative results. Depth Pro dramatically outperforms all prior work in sharp delineation of object boundaries, including fine structures such as hair, fur, and vegetation. As shown in Fig. [2](https://arxiv.org/html/2410.02073v1#S1.F2 "Figure 2 ‣ 1 Introduction ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second"), Depth Pro offers unparalleled boundary tracing, outperforming all prior work by a multiplicative factor in boundary recall. (See Sec. [4](https://arxiv.org/html/2410.02073v1#S4 "4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") for additional detail.) Compared to the prior state of the art in boundary accuracy (Ke et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib45); Li et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib61)), Depth Pro is one to two orders of magnitude faster, yields much more accurate boundaries, and provides metric depth maps with absolute scale.

Depth Pro is enabled by a number of technical contributions. First, we design an efficient multi-scale ViT-based architecture for capturing the global image context while also adhering to fine structures at high resolution. Second, we derive a new set of metrics that enable leveraging highly accurate matting datasets for quantifying the accuracy of boundary tracing in evaluating monocular depth maps. Third, we devise a set of loss functions and a training curriculum that promote sharp depth estimates while training on real-world datasets that provide coarse and inaccurate supervision around boundaries, along with synthetic datasets that offer accurate pixelwise ground truth but limited realism. Fourth, we contribute zero-shot focal length estimation from a single image that dramatically outperforms the prior state of the art.

## 2 Related work

Early work on monocular depth estimation focused on training on individual datasets recorded with a single camera (Saxena et al., [2009](https://arxiv.org/html/2410.02073v1#bib.bib85); Eigen et al., [2014](https://arxiv.org/html/2410.02073v1#bib.bib24); Eigen & Fergus, [2015](https://arxiv.org/html/2410.02073v1#bib.bib23)). Although this setup directly enabled metric depth predictions, it was limited to single datasets and narrow domains.

Zero-shot depth estimation. MegaDepth (Li & Snavely, [2018](https://arxiv.org/html/2410.02073v1#bib.bib60)) demonstrated that training on a diverse dataset allows generalizing monocular depth prediction beyond a specific domain. MiDaS (Ranftl et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib83)) advanced this idea by training on a large mix of diverse datasets with a scale-and-shift-invariant loss. Follow-up works applied this recipe to transformer-based architectures (Ranftl et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib82); Birkl et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib7)) and further expanded the set of feasible datasets through self-supervision (Spencer et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib94); Yang et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib112)). A line of work uses self-supervision to learn from unlabeled image and video data (Petrovai & Nedevschi, [2022](https://arxiv.org/html/2410.02073v1#bib.bib75); Yang et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib112)). A number of recent approaches (Ke et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib45); Gui et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib33)) harness diffusion models to synthesize relative depth maps. Although some of these methods demonstrated excellent generalization, their predictions are ambiguous in scale and shift, which precludes downstream applications that require accurate shapes, sizes, or distances.

Zero-shot metric depth. A line of work sought to improve metric depth prediction through a global distribution of depth values (Fu et al., [2018](https://arxiv.org/html/2410.02073v1#bib.bib29); Bhat et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib4); [2022](https://arxiv.org/html/2410.02073v1#bib.bib5); Li et al., [2024b](https://arxiv.org/html/2410.02073v1#bib.bib62)) and further conditioning on scene type (Bhat et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib6)). A different approach directly takes into account camera intrinsics. Cam-Convs (Fácil et al., [2019](https://arxiv.org/html/2410.02073v1#bib.bib26)) conditioned convolutions on the camera intrinsics. LeReS (Yin et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib115)) trains a separate network for undistorting point clouds to recover scale and shift, Metric3D (Yin et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib116)) scales images or depth maps to a canonical space and remaps estimated depth given the focal length, and ZeroDepth (Guizilini et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib35)) learns camera-specific embedddings in a variational framework. DMD (Saxena et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib86)) conditions a diffusion model on the field of view. Metric3D v2 (Hu et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib38)) leverages surface normals as an auxilliary output to improve metric depth. All of these methods require the camera intrinsics to be known and accurate. More recent works attempt to reason about unknown camera intrinsics either through a separate network (Spencer et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib95)) or by predicting a camera embedding for conditioning its depth predictions in a spherical space (Piccinelli et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib76)). Akin to these recent approaches, our method does not require the focal length to be provided as input. We propose to directly estimate the field of view from intermediate features of the depth prediction network, and show that this substantially outperforms the prior state of the art in the task of cross-domain focal length estimation.

Sharp occluding contours. SharpNet (Ramamonjisoa & Lepetit, [2019](https://arxiv.org/html/2410.02073v1#bib.bib79)) incorporates normals and occluding contour constraints, but requires additional contour and normal supervision during training. BoostingDepth (Miangoleh et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib70)) obtains detailed predictions from a low-resolution network by applying it independently to image patches. Since the patches lack global context, BoostingDepth fuses them through a sophisticated multi-step pipeline. PatchFusion (Li et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib61)) refines this concept through image-adaptive patch sampling and tailored modules that enable end-to-end training. A recent line of work leverages diffusion priors to enhance the sharpness of occlusion boundaries (Gui et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib33); Ke et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib45)). These approaches predominantly focus on predicting relative (rather than metric) depth. We propose a simpler architecture without task-specific modules or diffusion priors and demonstrate that even sharper and more accurate results can be obtained while producing metric depth maps and reducing runtime by more than two orders of magnitude.

Guided depth super-resolution uses the input image to upsample low-resolution depth predictions (Metzger et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib69); Zhong et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib123)). SMDNet (Tosi et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib100)) predicts bimodal mixture densities to sharpen occluding contours. And Ramamonjisoa et al. (Ramamonjisoa et al., [2020](https://arxiv.org/html/2410.02073v1#bib.bib80)) introduce a module for learning to sharpen depth boundaries of a pretrained network. These works are orthogonal to ours and could be applied to further upsample our high-resolution predictions.

To evaluate boundary tracing in predicted depth maps, Koch et al. ([2018](https://arxiv.org/html/2410.02073v1#bib.bib50)) introduce the iBims dataset with manual annotations of occluding contours and corresponding metrics. The need for manual annotation and highly accurate depth ground truth constrain the benchmark to a small set of indoor scenes. We contribute metrics based on segmentation and matting datasets that provide a complementary view by enabling evaluation on complex, dynamic environments or scenes with exceedingly fine detail for which ground-truth depth is impossible to obtain.

Multi-scale vision transformers. Vision transformers (ViTs) have emerged as the dominant general-purpose architecture for perception tasks, but operate at low resolution (Dosovitskiy et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib22)). Naïvely scaling the architecture to higher resolutions is prohibitive due to the computational complexity. Several works identified the attention layers as the main obstacle to scaling up ViT and have proposed alternatives (Zhu et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib124); Liu et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib65); Li et al., [2022c](https://arxiv.org/html/2410.02073v1#bib.bib59); Chu et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib16); Liu et al., [2022a](https://arxiv.org/html/2410.02073v1#bib.bib66); [2023](https://arxiv.org/html/2410.02073v1#bib.bib64); Cai et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib12); Jaegle et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib42)).

Another line of work modified the ViT architecture to produce a hierarchy of features (Fan et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib27); Xie et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib111); Yuan et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib118); Ranftl et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib82); Chen et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib13); Lee et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib54)).

Rather than modifying the ViT architecture, which requires computationally expensive retraining, we propose a network architecture that applies a plain ViT backbone at multiple scales and fuses predictions into a single high-resolution output. This architecture benefits from ongoing improvements in ViT pretraining, as new variants can be easily swapped in (Oquab et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib72); Peng et al., [2022b](https://arxiv.org/html/2410.02073v1#bib.bib74); Sun et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib97)).

Pretrained vision transformers have been adapted for semantic segmenation and object detection. ViT-Adapter (Chen et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib15)) and ViT-CoMer (Xia et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib108)) supplement a pretrained ViT with a convolutional network for dense prediction, whereas ViT-Det (Li et al., [2022b](https://arxiv.org/html/2410.02073v1#bib.bib58)) builds a feature pyramid on top of a pretrained ViT. Distinct from these, we fuse features from the ViT applied at multiple scales to learn global context together with local detail.

## 3 Method

### 3.1 Network

The key idea of our architecture is to apply plain ViT encoders (Dosovitskiy et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib22)) on patches extracted at multiple scales and fuse the patch predictions into a single high-resolution dense prediction in an end-to-end trainable model. Fig. [3](https://arxiv.org/html/2410.02073v1#S3.F3 "Figure 3 ‣ 3.1 Network ‣ 3 Method ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") illustrates the architecture. For predicting depth, we employ two ViT encoders, a patch encoder and an image encoder. The patch encoder is applied on patches extracted at multiple scales. Intuitively, this may allow learning representations that are scale-invariant as weights are shared across scales. The image encoder anchors the patch predictions in a global context. It is applied to the whole input image, downsampled to the base input resolution of the chosen encoder backbone (in our case 384×\\times×384).

![Refer to caption](chrome-extension://pcmpcfapbekmbjjkdalcgopdkipoggdi/html/2410.02073v1/x3.jpeg)

Figure 3: Overview of the network architecture. An image is downsampled at several scales. At each scale, it is split into patches, which are processed by a ViT-based patch encoder, with weights shared across scales. Patches are merged into feature maps, upsampled, and fused via a DPT decoder. Predictions are anchored by a separate image encoder that provides global context.

The whole network operates at a fixed resolution of 1536×\\times×1536, which was chosen as a multiple of the ViT’s 384×\\times×384\. This guarantees a sufficiently large receptive field and constant runtimes for any image while preventing out-of-memory errors (which we repeatedly observed for variable-resolution approaches on large images). Confirming this design choice, the results we report in Sec. [4](https://arxiv.org/html/2410.02073v1#S4 "4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") and Tab. [5](https://arxiv.org/html/2410.02073v1#A1.T5 "Table 5 ‣ A.3 Runtime ‣ Appendix A Additional Results ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") demonstrate that Depth Pro is consistently orders of magnitude faster than variable-resolution approaches while being more accurate and producing sharper boundaries. A key benefit of assembling our architecture from plain ViT encoders over custom encoders is the abundance of pretrained ViT-based backbones that can be harnessed (Oquab et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib72); Peng et al., [2022b](https://arxiv.org/html/2410.02073v1#bib.bib74); Sun et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib97)). We evaluate several pretrained backbones and compare our architecture to other high-resolution architectures in the appendices (Tab. [8](https://arxiv.org/html/2410.02073v1#A2.T8 "Table 8 ‣ B.2 High-resolution alternatives ‣ Appendix B Controlled Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") and Sec. [B.2](https://arxiv.org/html/2410.02073v1#A2.SS2 "B.2 High-resolution alternatives ‣ Appendix B Controlled Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second")).

After downsampling to 1536×\\times×1536, the input image is split into patches of 384×384384384384\\times 384384 × 384. For the two finest scales, we let patches overlap to avoid seams. At each scale, the patches are fed into the patch encoder, which produces a feature tensor at resolution 24×24242424\\times 2424 × 24 per input patch (features 3 – 6 in Fig. [3](https://arxiv.org/html/2410.02073v1#S3.F3 "Figure 3 ‣ 3.1 Network ‣ 3 Method ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second")). At the finest scale we further extract intermediate features (features 1 & 2 in Fig. [3](https://arxiv.org/html/2410.02073v1#S3.F3 "Figure 3 ‣ 3.1 Network ‣ 3 Method ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second")) to capture finer-grained details. We merge the feature patches into maps, which are fed into the decoder module, which resembles the DPT decoder (Ranftl et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib82)).

In addition to sharing representations across scales, the patch-based application of the encoder network allows trivial parallelization as patches can be processed independently. Another source of computational efficiency comes from the lower computational complexity of patch-based processing in comparison to scaling up the ViT to higher resolutions. The reason is multi-head self-attention (Vaswani et al., [2017](https://arxiv.org/html/2410.02073v1#bib.bib102)), whose computational complexity scales quadratically with the number of input pixels, and thus quartically in image dimension.

### 3.2 Sharp monocular depth estimation

#### Training objectives.

For each input image I𝐼Iitalic\_I, our network f𝑓fitalic\_f predicts a canonical inverse depth image C\=f⁢(I)𝐶𝑓𝐼C=f(I)italic\_C = italic\_f ( italic\_I ). To obtain a dense metric depth map Dmsubscript𝐷𝑚D\_{m}italic\_D start\_POSTSUBSCRIPT italic\_m end\_POSTSUBSCRIPT, we scale by the horizontal field of view, represented by the focal length f𝑝𝑥subscript𝑓𝑝𝑥f\_{\\mathit{px}}italic\_f start\_POSTSUBSCRIPT italic\_px end\_POSTSUBSCRIPT and the width w𝑤witalic\_w (Yin et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib116)): Dm\=f𝑝𝑥w⁢C.subscript𝐷𝑚subscript𝑓𝑝𝑥𝑤𝐶D\_{m}=\\tfrac{f\_{\\mathit{px}}}{wC}.italic\_D start\_POSTSUBSCRIPT italic\_m end\_POSTSUBSCRIPT = divide start\_ARG italic\_f start\_POSTSUBSCRIPT italic\_px end\_POSTSUBSCRIPT end\_ARG start\_ARG italic\_w italic\_C end\_ARG .

We train with several objectives, all based on canonical inverse depth, because this prioritizes areas close to the camera over farther areas or the whole scene, and thus supports visual quality in applications such as novel view synthesis. Let C^^𝐶\\hat{C}over^ start\_ARG italic\_C end\_ARG be the ground-truth canonical inverse depth. For all metric datasets we compute the mean absolute error (ℒ𝑀𝐴𝐸subscriptℒ𝑀𝐴𝐸\\mathcal{L}\_{\\mathit{MAE}}caligraphic\_L start\_POSTSUBSCRIPT italic\_MAE end\_POSTSUBSCRIPT, Eq. [1](https://arxiv.org/html/2410.02073v1#S3.E1 "In Training objectives. ‣ 3.2 Sharp monocular depth estimation ‣ 3 Method ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second")) per pixel i𝑖iitalic\_i, and discard pixels with an error in the top 20%percent2020\\%20 % per image for real-world (as opposed to synthetic) datasets:

<table id="A4.EGx1"><tbody id="S3.E1"><tr><td></td><td><math alttext="\displaystyle\mathcal{L}_{\mathit{MAE}}(\hat{C},C)=\frac{1}{N}\sum^{N}_{i}|%
\hat{C}_{i}-C_{i}|." display="inline" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><msub id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml"><mi id="S3.E1.m1.3.3.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E1.m1.3.3.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.3.2.3.cmml">𝑀𝐴𝐸</mi></msub><mo id="S3.E1.m1.3.3.1.1.3.1" xref="S3.E1.m1.3.3.1.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml"><mo id="S3.E1.m1.3.3.1.1.3.3.2.1" stretchy="false" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">(</mo><mover accent="true" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mi id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">C</mi><mo id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml">^</mo></mover><mo id="S3.E1.m1.3.3.1.1.3.3.2.2" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">C</mi><mo id="S3.E1.m1.3.3.1.1.3.3.2.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml"><mfrac id="S3.E1.m1.3.3.1.1.1.3a" xref="S3.E1.m1.3.3.1.1.1.3.cmml"><mn id="S3.E1.m1.3.3.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.3.2.cmml">1</mn><mi id="S3.E1.m1.3.3.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.3.3.cmml">N</mi></mfrac></mstyle><mo id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><munderover id="S3.E1.m1.3.3.1.1.1.1.2a" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mi id="S3.E1.m1.3.3.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E1.m1.3.3.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">C</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">C</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" lspace="0em" xref="S3.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><times id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1"></times><apply id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2">ℒ</ci><ci id="S3.E1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.3">𝑀𝐴𝐸</ci></apply><interval closure="open" id="S3.E1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><ci id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1">^</ci><ci id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2">𝐶</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐶</ci></interval></apply><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3"><divide id="S3.E1.m1.3.3.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.3"></divide><cn id="S3.E1.m1.3.3.1.1.1.3.2.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.1.3.2">1</cn><ci id="S3.E1.m1.3.3.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3.3">𝑁</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">superscript</csymbol><sum id="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2"></sum><ci id="S3.E1.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3">𝑁</ci></apply><ci id="S3.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1"><abs id="S3.E1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2"></abs><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><minus id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2"><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.2.2">𝐶</ci></apply><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.2">𝐶</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\displaystyle\mathcal{L}_{\mathit{MAE}}(\hat{C},C)=\frac{1}{N}\sum^{N}_{i}|% \hat{C}_{i}-C_{i}|.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">caligraphic_L start_POSTSUBSCRIPT italic_MAE end_POSTSUBSCRIPT ( over^ start_ARG italic_C end_ARG , italic_C ) = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | over^ start_ARG italic_C end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | .</annotation></semantics></math></td><td></td><td rowspan="1"><span>(1)</span></td></tr></tbody></table>

For all non-metric datasets (i.e., those without reliable camera intrinsics or inconsistent scale), we normalize predictions and ground truth via the mean absolute deviation from the median (Ranftl et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib83)) before applying a loss. We further compute errors on the first and second derivatives of (canoncial) inverse depth maps at multiple scales. Let ∇∗subscript∇\\nabla\_{\*}∇ start\_POSTSUBSCRIPT ∗ end\_POSTSUBSCRIPT indicate a spatial derivative operator ∗\*∗, such as Scharr (S) (Scharr et al., [1997](https://arxiv.org/html/2410.02073v1#bib.bib87)) or Laplace (L), and p𝑝pitalic\_p the error norm. We define the multi-scale derivative loss over M𝑀Mitalic\_M scales as

<table id="A4.EGx2"><tbody id="S3.E2"><tr><td></td><td><math alttext="\displaystyle\mathcal{L}_{*,p,M}(C,\hat{C})=\frac{1}{M}\sum^{M}_{j}\frac{1}{N_%
{j}}\sum_{i}^{N_{j}}|\nabla_{*}C^{j}_{i}-\nabla_{*}\hat{C}^{j}_{i}|^{p}," display="inline" id="S3.E2.m1.6"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1" xref="S3.E2.m1.6.6.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.3" xref="S3.E2.m1.6.6.1.1.3.cmml"><msub id="S3.E2.m1.6.6.1.1.3.2" xref="S3.E2.m1.6.6.1.1.3.2.cmml"><mi id="S3.E2.m1.6.6.1.1.3.2.2" xref="S3.E2.m1.6.6.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E2.m1.3.3.3.5" xref="S3.E2.m1.3.3.3.4.cmml"><mo id="S3.E2.m1.1.1.1.1" rspace="0em" xref="S3.E2.m1.1.1.1.1.cmml">∗</mo><mo id="S3.E2.m1.3.3.3.5.1" xref="S3.E2.m1.3.3.3.4.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">p</mi><mo id="S3.E2.m1.3.3.3.5.2" xref="S3.E2.m1.3.3.3.4.cmml">,</mo><mi id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.3.cmml">M</mi></mrow></msub><mo id="S3.E2.m1.6.6.1.1.3.1" xref="S3.E2.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.3.3.2" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml"><mo id="S3.E2.m1.6.6.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml">(</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">C</mi><mo id="S3.E2.m1.6.6.1.1.3.3.2.2" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml">,</mo><mover accent="true" id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml"><mi id="S3.E2.m1.5.5.2" xref="S3.E2.m1.5.5.2.cmml">C</mi><mo id="S3.E2.m1.5.5.1" xref="S3.E2.m1.5.5.1.cmml">^</mo></mover><mo id="S3.E2.m1.6.6.1.1.3.3.2.3" stretchy="false" xref="S3.E2.m1.6.6.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.2" xref="S3.E2.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.m1.6.6.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.3.cmml"><mfrac id="S3.E2.m1.6.6.1.1.1.3a" xref="S3.E2.m1.6.6.1.1.1.3.cmml"><mn id="S3.E2.m1.6.6.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.3.2.cmml">1</mn><mi id="S3.E2.m1.6.6.1.1.1.3.3" xref="S3.E2.m1.6.6.1.1.1.3.3.cmml">M</mi></mfrac></mstyle><mo id="S3.E2.m1.6.6.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.m1.6.6.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml"><munderover id="S3.E2.m1.6.6.1.1.1.1.2a" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E2.m1.6.6.1.1.1.1.2.2.2.cmml">∑</mo><mi id="S3.E2.m1.6.6.1.1.1.1.2.3" xref="S3.E2.m1.6.6.1.1.1.1.2.3.cmml">j</mi><mi id="S3.E2.m1.6.6.1.1.1.1.2.2.3" xref="S3.E2.m1.6.6.1.1.1.1.2.2.3.cmml">M</mi></munderover></mstyle><mrow id="S3.E2.m1.6.6.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.m1.6.6.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.3.cmml"><mfrac id="S3.E2.m1.6.6.1.1.1.1.1.3a" xref="S3.E2.m1.6.6.1.1.1.1.1.3.cmml"><mn id="S3.E2.m1.6.6.1.1.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.1.1.3.2.cmml">1</mn><msub id="S3.E2.m1.6.6.1.1.1.1.1.3.3" xref="S3.E2.m1.6.6.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.3.3.2" xref="S3.E2.m1.6.6.1.1.1.1.1.3.3.2.cmml">N</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.3.3.3" xref="S3.E2.m1.6.6.1.1.1.1.1.3.3.3.cmml">j</mi></msub></mfrac></mstyle><mo id="S3.E2.m1.6.6.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.m1.6.6.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.cmml"><munderover id="S3.E2.m1.6.6.1.1.1.1.1.1.2a" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.3.cmml">i</mi><msub id="S3.E2.m1.6.6.1.1.1.1.1.1.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.2.cmml">N</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></munderover></mstyle><msup id="S3.E2.m1.6.6.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.2" rspace="0.167em" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.2.cmml">∇</mo><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.3.cmml">∗</mo></msub><msubsup id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">C</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">j</mi></msubsup></mrow><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.2" rspace="0.167em" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.2.cmml">∇</mo><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.3.cmml">∗</mo></msub><msubsup id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2.2.cmml">C</mi><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2.1.cmml">^</mo></mover><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml">j</mi></msubsup></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mi id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.cmml">p</mi></msup></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.6.6.1.2" xref="S3.E2.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.1.1.cmml" xref="S3.E2.m1.6.6.1"><eq id="S3.E2.m1.6.6.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.2"></eq><apply id="S3.E2.m1.6.6.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.3"><times id="S3.E2.m1.6.6.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.3.1"></times><apply id="S3.E2.m1.6.6.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.3.2.1.cmml" xref="S3.E2.m1.6.6.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.3.2.2.cmml" xref="S3.E2.m1.6.6.1.1.3.2.2">ℒ</ci><list id="S3.E2.m1.3.3.3.4.cmml" xref="S3.E2.m1.3.3.3.5"><times id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"></times><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑝</ci><ci id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3">𝑀</ci></list></apply><interval closure="open" id="S3.E2.m1.6.6.1.1.3.3.1.cmml" xref="S3.E2.m1.6.6.1.1.3.3.2"><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝐶</ci><apply id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5"><ci id="S3.E2.m1.5.5.1.cmml" xref="S3.E2.m1.5.5.1">^</ci><ci id="S3.E2.m1.5.5.2.cmml" xref="S3.E2.m1.5.5.2">𝐶</ci></apply></interval></apply><apply id="S3.E2.m1.6.6.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2"></times><apply id="S3.E2.m1.6.6.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.3"><divide id="S3.E2.m1.6.6.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.3"></divide><cn id="S3.E2.m1.6.6.1.1.1.3.2.cmml" type="integer" xref="S3.E2.m1.6.6.1.1.1.3.2">1</cn><ci id="S3.E2.m1.6.6.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.3.3">𝑀</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1"><apply id="S3.E2.m1.6.6.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2">subscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2">superscript</csymbol><sum id="S3.E2.m1.6.6.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.2.2"></sum><ci id="S3.E2.m1.6.6.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.2.3">𝑀</ci></apply><ci id="S3.E2.m1.6.6.1.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.2"></times><apply id="S3.E2.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3"><divide id="S3.E2.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3"></divide><cn id="S3.E2.m1.6.6.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E2.m1.6.6.1.1.1.1.1.3.2">1</cn><apply id="S3.E2.m1.6.6.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3.3.2">𝑁</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1"><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.2"></sum><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.2">𝑁</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1"><abs id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2"><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.2">∇</ci><times id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.1.3"></times></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝐶</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑗</ci></apply><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3"><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.2">∇</ci><times id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.1.3"></times></apply><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2"><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2.1">^</ci><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.2.2">𝐶</ci></apply><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.2.3">𝑗</ci></apply><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply></apply></apply></apply><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.3">𝑝</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">\displaystyle\mathcal{L}_{*,p,M}(C,\hat{C})=\frac{1}{M}\sum^{M}_{j}\frac{1}{N_% {j}}\sum_{i}^{N_{j}}|\nabla_{*}C^{j}_{i}-\nabla_{*}\hat{C}^{j}_{i}|^{p},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.6d">caligraphic_L start_POSTSUBSCRIPT ∗ , italic_p , italic_M end_POSTSUBSCRIPT ( italic_C , over^ start_ARG italic_C end_ARG ) = divide start_ARG 1 end_ARG start_ARG italic_M end_ARG ∑ start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_N start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT | ∇ start_POSTSUBSCRIPT ∗ end_POSTSUBSCRIPT italic_C start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - ∇ start_POSTSUBSCRIPT ∗ end_POSTSUBSCRIPT over^ start_ARG italic_C end_ARG start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT ,</annotation></semantics></math></td><td></td><td rowspan="1"><span>(2)</span></td></tr></tbody></table>

where the scales j𝑗jitalic\_j are computed by blurring and downsampling the inverse depth maps by a factor of 2 per scale. As shorthands we define the Mean Absolute Gradient Error ℒ𝑀𝐴𝐺𝐸\=ℒS,1,6subscriptℒ𝑀𝐴𝐺𝐸subscriptℒ𝑆16\\mathcal{L}\_{\\mathit{MAGE}}=\\mathcal{L}\_{S,1,6}caligraphic\_L start\_POSTSUBSCRIPT italic\_MAGE end\_POSTSUBSCRIPT = caligraphic\_L start\_POSTSUBSCRIPT italic\_S , 1 , 6 end\_POSTSUBSCRIPT, the Mean Absolute Laplace Error ℒ𝑀𝐴𝐿𝐸\=ℒL,1,6subscriptℒ𝑀𝐴𝐿𝐸subscriptℒ𝐿16\\mathcal{L}\_{\\mathit{MALE}}=\\mathcal{L}\_{L,1,6}caligraphic\_L start\_POSTSUBSCRIPT italic\_MALE end\_POSTSUBSCRIPT = caligraphic\_L start\_POSTSUBSCRIPT italic\_L , 1 , 6 end\_POSTSUBSCRIPT, and the Mean Squared Gradient Error ℒ𝑀𝑆𝐺𝐸\=ℒS,2,6subscriptℒ𝑀𝑆𝐺𝐸subscriptℒ𝑆26\\mathcal{L}\_{\\mathit{MSGE}}=\\mathcal{L}\_{S,2,6}caligraphic\_L start\_POSTSUBSCRIPT italic\_MSGE end\_POSTSUBSCRIPT = caligraphic\_L start\_POSTSUBSCRIPT italic\_S , 2 , 6 end\_POSTSUBSCRIPT.

#### Training curriculum.

We propose a training curriculum motivated by the following observations. First, training on a large mix of real-world and synthetic datasets improves generalization as measured by zero-shot accuracy (Ranftl et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib83); [2021](https://arxiv.org/html/2410.02073v1#bib.bib82); Yang et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib112); Hu et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib38)). Second, synthetic datasets provide pixel-accurate ground truth, whereas real-world datasets often contain missing areas, mismatched depth, or false measurements on object boundaries. Third, predictions get sharper over the course of training.

Based on these observations, we design a two-stage training curriculum. In the first stage, we aim to learn robust features that allow the network to generalize across domains. To that end, we train on a mix of all labeled training sets. Specifically, we minimize ℒ𝑀𝐴𝐸subscriptℒ𝑀𝐴𝐸\\mathcal{L}\_{\\mathit{MAE}}caligraphic\_L start\_POSTSUBSCRIPT italic\_MAE end\_POSTSUBSCRIPT on metric datasets and its normalized version on non-metric datasets. ℒ𝑀𝐴𝐸subscriptℒ𝑀𝐴𝐸\\mathcal{L}\_{\\mathit{MAE}}caligraphic\_L start\_POSTSUBSCRIPT italic\_MAE end\_POSTSUBSCRIPT is chosen for its robustness in handling potentially corrupted real-world ground truth. To steer the network towards sharp boundaries, we aim to also supervise on gradients of the predictions. Done naïvely, however, this can hinder optimization and slow down convergence. We found that a scale-and-shift-invariant loss on gradients, applied only to synthetic datasets, worked best. Controlled experiments are reported in the appendices.

The second stage of training is designed to sharpen boundaries and reveal fine details in the predicted depth maps. To minimize the effect of inaccurate ground truth, at this stage we only train on synthetic datasets that provide high-quality pixel-accurate ground truth. (Note that this inverts the common practice of first training on synthetic data and then fine-tuning on real data (Gaidon et al., [2016](https://arxiv.org/html/2410.02073v1#bib.bib30); Gómez et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib32); Sun et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib96)).) Specifically, we again minimize the ℒ𝑀𝐴𝐸subscriptℒ𝑀𝐴𝐸\\mathcal{L}\_{\\mathit{MAE}}caligraphic\_L start\_POSTSUBSCRIPT italic\_MAE end\_POSTSUBSCRIPT and supplement it with a selection of losses on the first- and second-order derivatives: ℒ𝑀𝐴𝐺𝐸subscriptℒ𝑀𝐴𝐺𝐸\\mathcal{L}\_{\\mathit{MAGE}}caligraphic\_L start\_POSTSUBSCRIPT italic\_MAGE end\_POSTSUBSCRIPT, ℒ𝑀𝐴𝐿𝐸subscriptℒ𝑀𝐴𝐿𝐸\\mathcal{L}\_{\\mathit{MALE}}caligraphic\_L start\_POSTSUBSCRIPT italic\_MALE end\_POSTSUBSCRIPT, and ℒ𝑀𝑆𝐺𝐸subscriptℒ𝑀𝑆𝐺𝐸\\mathcal{L}\_{\\mathit{MSGE}}caligraphic\_L start\_POSTSUBSCRIPT italic\_MSGE end\_POSTSUBSCRIPT. We provide a detailed specification of the loss functions that are applied at each stage in the appendices.

#### Evaluation metrics for sharp boundaries.

Applications such as novel view synthesis require depth maps to adhere to object boundaries. This is particularly challenging for thin structures. Misaligned or blurry boundaries can make objects appear distorted or split into parts. Common benchmarks for monocular depth prediction rarely take boundary sharpness into account. This may be attributed in part to the lack of diverse and realistic datasets with precise pixel-accurate ground-truth depth. To address this shortcoming, we propose a new set of metrics specifically for the evaluation of depth boundaries. Our key observation is that we can leverage existing high-quality annotations for matting, saliency, or segmentation as ground truth for depth boundaries. We treat annotations for these tasks as binary maps, which define a foreground/background relationship between an object and its environment. (This relationship may not hold in every case, especially for segmentation masks. However, we can easily discard such problematic cases through manual inspection. It is much easier to filter out a segmentation mask than to annotate it.) To ensure that the relationship holds, we only consider pixels around edges in the binary map.

We first define the metrics for depth maps and later derive the formulation for binary segmentation masks. Motivated by the ranking loss (Chen et al., [2016](https://arxiv.org/html/2410.02073v1#bib.bib14)), we use the pairwise depth ratio of neighboring pixels to define a foreground/background relationship. Let i,j𝑖𝑗i,jitalic\_i , italic\_j be the locations of two neighboring pixels. We then define an occluding contour cdsubscript𝑐𝑑c\_{d}italic\_c start\_POSTSUBSCRIPT italic\_d end\_POSTSUBSCRIPT derived from a depth map d𝑑ditalic\_d as cd⁢(i,j)\=\[d⁢(j)d⁢(i)\>(1+t100)\]subscript𝑐𝑑𝑖𝑗delimited-\[\]𝑑𝑗𝑑𝑖1𝑡100c\_{d}(i,j)=\\left\[\\tfrac{d(j)}{d(i)}>(1+\\tfrac{t}{100})\\right\]italic\_c start\_POSTSUBSCRIPT italic\_d end\_POSTSUBSCRIPT ( italic\_i , italic\_j ) = \[ divide start\_ARG italic\_d ( italic\_j ) end\_ARG start\_ARG italic\_d ( italic\_i ) end\_ARG > ( 1 + divide start\_ARG italic\_t end\_ARG start\_ARG 100 end\_ARG ) \], where \[⋅\]delimited-\[\]⋅\[\\cdot\]\[ ⋅ \] is the Iverson bracket. Intuitively, this indicates the presence of an occluding contour between pixels i𝑖iitalic\_i and j𝑗jitalic\_j if their corresponding depth differs by more than t%percent𝑡t\\%italic\_t %. For all pairs of neighboring pixels, we can then compute the precision (P𝑃Pitalic\_P) and recall (R𝑅Ritalic\_R) as

<table id="S3.E3"><tbody><tr><td></td><td><math alttext="\text{P}(t)=\frac{\sum_{i,j\in N(i)}c_{d}(i,j)\wedge c_{\hat{d}}(i,j)}{\sum_{i%
,j\in N(i)}c_{d}(i,j)}\text{ and }\text{R}(t)=\frac{\sum_{i,j\in N(i)}c_{d}(i,%
j)\wedge c_{\hat{d}}(i,j)}{\sum_{i,j\in N(i)}c_{\hat{d}}(i,j)}." display="block" id="S3.E3.m1.27"><semantics id="S3.E3.m1.27a"><mrow id="S3.E3.m1.27.27.1" xref="S3.E3.m1.27.27.1.1.cmml"><mrow id="S3.E3.m1.27.27.1.1" xref="S3.E3.m1.27.27.1.1.cmml"><mrow id="S3.E3.m1.27.27.1.1.2" xref="S3.E3.m1.27.27.1.1.2.cmml"><mtext id="S3.E3.m1.27.27.1.1.2.2" xref="S3.E3.m1.27.27.1.1.2.2a.cmml">P</mtext><mo id="S3.E3.m1.27.27.1.1.2.1" xref="S3.E3.m1.27.27.1.1.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.27.27.1.1.2.3.2" xref="S3.E3.m1.27.27.1.1.2.cmml"><mo id="S3.E3.m1.27.27.1.1.2.3.2.1" stretchy="false" xref="S3.E3.m1.27.27.1.1.2.cmml">(</mo><mi id="S3.E3.m1.25.25" xref="S3.E3.m1.25.25.cmml">t</mi><mo id="S3.E3.m1.27.27.1.1.2.3.2.2" stretchy="false" xref="S3.E3.m1.27.27.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.27.27.1.1.3" xref="S3.E3.m1.27.27.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.27.27.1.1.4" xref="S3.E3.m1.27.27.1.1.4.cmml"><mfrac id="S3.E3.m1.12.12" xref="S3.E3.m1.12.12.cmml"><mrow id="S3.E3.m1.7.7.7" xref="S3.E3.m1.7.7.7.cmml"><mrow id="S3.E3.m1.7.7.7.9" xref="S3.E3.m1.7.7.7.9.cmml"><msub id="S3.E3.m1.7.7.7.9.1" xref="S3.E3.m1.7.7.7.9.1.cmml"><mo id="S3.E3.m1.7.7.7.9.1.2" xref="S3.E3.m1.7.7.7.9.1.2.cmml">∑</mo><mrow id="S3.E3.m1.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.cmml"><mrow id="S3.E3.m1.3.3.3.3.3.5.2" xref="S3.E3.m1.3.3.3.3.3.5.1.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.cmml">i</mi><mo id="S3.E3.m1.3.3.3.3.3.5.2.1" xref="S3.E3.m1.3.3.3.3.3.5.1.cmml">,</mo><mi id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml">j</mi></mrow><mo id="S3.E3.m1.3.3.3.3.3.4" xref="S3.E3.m1.3.3.3.3.3.4.cmml">∈</mo><mrow id="S3.E3.m1.3.3.3.3.3.6" xref="S3.E3.m1.3.3.3.3.3.6.cmml"><mi id="S3.E3.m1.3.3.3.3.3.6.2" xref="S3.E3.m1.3.3.3.3.3.6.2.cmml">N</mi><mo id="S3.E3.m1.3.3.3.3.3.6.1" xref="S3.E3.m1.3.3.3.3.3.6.1.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.3.3.3.6.3.2" xref="S3.E3.m1.3.3.3.3.3.6.cmml"><mo id="S3.E3.m1.3.3.3.3.3.6.3.2.1" stretchy="false" xref="S3.E3.m1.3.3.3.3.3.6.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E3.m1.3.3.3.3.3.6.3.2.2" stretchy="false" xref="S3.E3.m1.3.3.3.3.3.6.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="S3.E3.m1.7.7.7.9.2" xref="S3.E3.m1.7.7.7.9.2.cmml"><msub id="S3.E3.m1.7.7.7.9.2.2" xref="S3.E3.m1.7.7.7.9.2.2.cmml"><mi id="S3.E3.m1.7.7.7.9.2.2.2" xref="S3.E3.m1.7.7.7.9.2.2.2.cmml">c</mi><mi id="S3.E3.m1.7.7.7.9.2.2.3" xref="S3.E3.m1.7.7.7.9.2.2.3.cmml">d</mi></msub><mo id="S3.E3.m1.7.7.7.9.2.1" xref="S3.E3.m1.7.7.7.9.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.7.7.7.9.2.3.2" xref="S3.E3.m1.7.7.7.9.2.3.1.cmml"><mo id="S3.E3.m1.7.7.7.9.2.3.2.1" stretchy="false" xref="S3.E3.m1.7.7.7.9.2.3.1.cmml">(</mo><mi id="S3.E3.m1.4.4.4.4" xref="S3.E3.m1.4.4.4.4.cmml">i</mi><mo id="S3.E3.m1.7.7.7.9.2.3.2.2" xref="S3.E3.m1.7.7.7.9.2.3.1.cmml">,</mo><mi id="S3.E3.m1.5.5.5.5" xref="S3.E3.m1.5.5.5.5.cmml">j</mi><mo id="S3.E3.m1.7.7.7.9.2.3.2.3" stretchy="false" xref="S3.E3.m1.7.7.7.9.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.7.7.7.8" xref="S3.E3.m1.7.7.7.8.cmml">∧</mo><mrow id="S3.E3.m1.7.7.7.10" xref="S3.E3.m1.7.7.7.10.cmml"><msub id="S3.E3.m1.7.7.7.10.2" xref="S3.E3.m1.7.7.7.10.2.cmml"><mi id="S3.E3.m1.7.7.7.10.2.2" xref="S3.E3.m1.7.7.7.10.2.2.cmml">c</mi><mover accent="true" id="S3.E3.m1.7.7.7.10.2.3" xref="S3.E3.m1.7.7.7.10.2.3.cmml"><mi id="S3.E3.m1.7.7.7.10.2.3.2" xref="S3.E3.m1.7.7.7.10.2.3.2.cmml">d</mi><mo id="S3.E3.m1.7.7.7.10.2.3.1" xref="S3.E3.m1.7.7.7.10.2.3.1.cmml">^</mo></mover></msub><mo id="S3.E3.m1.7.7.7.10.1" xref="S3.E3.m1.7.7.7.10.1.cmml">⁢</mo><mrow id="S3.E3.m1.7.7.7.10.3.2" xref="S3.E3.m1.7.7.7.10.3.1.cmml"><mo id="S3.E3.m1.7.7.7.10.3.2.1" stretchy="false" xref="S3.E3.m1.7.7.7.10.3.1.cmml">(</mo><mi id="S3.E3.m1.6.6.6.6" xref="S3.E3.m1.6.6.6.6.cmml">i</mi><mo id="S3.E3.m1.7.7.7.10.3.2.2" xref="S3.E3.m1.7.7.7.10.3.1.cmml">,</mo><mi id="S3.E3.m1.7.7.7.7" xref="S3.E3.m1.7.7.7.7.cmml">j</mi><mo id="S3.E3.m1.7.7.7.10.3.2.3" stretchy="false" xref="S3.E3.m1.7.7.7.10.3.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E3.m1.12.12.12" xref="S3.E3.m1.12.12.12.cmml"><msub id="S3.E3.m1.12.12.12.6" xref="S3.E3.m1.12.12.12.6.cmml"><mo id="S3.E3.m1.12.12.12.6.2" xref="S3.E3.m1.12.12.12.6.2.cmml">∑</mo><mrow id="S3.E3.m1.10.10.10.3.3" xref="S3.E3.m1.10.10.10.3.3.cmml"><mrow id="S3.E3.m1.10.10.10.3.3.5.2" xref="S3.E3.m1.10.10.10.3.3.5.1.cmml"><mi id="S3.E3.m1.9.9.9.2.2.2" xref="S3.E3.m1.9.9.9.2.2.2.cmml">i</mi><mo id="S3.E3.m1.10.10.10.3.3.5.2.1" xref="S3.E3.m1.10.10.10.3.3.5.1.cmml">,</mo><mi id="S3.E3.m1.10.10.10.3.3.3" xref="S3.E3.m1.10.10.10.3.3.3.cmml">j</mi></mrow><mo id="S3.E3.m1.10.10.10.3.3.4" xref="S3.E3.m1.10.10.10.3.3.4.cmml">∈</mo><mrow id="S3.E3.m1.10.10.10.3.3.6" xref="S3.E3.m1.10.10.10.3.3.6.cmml"><mi id="S3.E3.m1.10.10.10.3.3.6.2" xref="S3.E3.m1.10.10.10.3.3.6.2.cmml">N</mi><mo id="S3.E3.m1.10.10.10.3.3.6.1" xref="S3.E3.m1.10.10.10.3.3.6.1.cmml">⁢</mo><mrow id="S3.E3.m1.10.10.10.3.3.6.3.2" xref="S3.E3.m1.10.10.10.3.3.6.cmml"><mo id="S3.E3.m1.10.10.10.3.3.6.3.2.1" stretchy="false" xref="S3.E3.m1.10.10.10.3.3.6.cmml">(</mo><mi id="S3.E3.m1.8.8.8.1.1.1" xref="S3.E3.m1.8.8.8.1.1.1.cmml">i</mi><mo id="S3.E3.m1.10.10.10.3.3.6.3.2.2" stretchy="false" xref="S3.E3.m1.10.10.10.3.3.6.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="S3.E3.m1.12.12.12.7" xref="S3.E3.m1.12.12.12.7.cmml"><msub id="S3.E3.m1.12.12.12.7.2" xref="S3.E3.m1.12.12.12.7.2.cmml"><mi id="S3.E3.m1.12.12.12.7.2.2" xref="S3.E3.m1.12.12.12.7.2.2.cmml">c</mi><mi id="S3.E3.m1.12.12.12.7.2.3" xref="S3.E3.m1.12.12.12.7.2.3.cmml">d</mi></msub><mo id="S3.E3.m1.12.12.12.7.1" xref="S3.E3.m1.12.12.12.7.1.cmml">⁢</mo><mrow id="S3.E3.m1.12.12.12.7.3.2" xref="S3.E3.m1.12.12.12.7.3.1.cmml"><mo id="S3.E3.m1.12.12.12.7.3.2.1" stretchy="false" xref="S3.E3.m1.12.12.12.7.3.1.cmml">(</mo><mi id="S3.E3.m1.11.11.11.4" xref="S3.E3.m1.11.11.11.4.cmml">i</mi><mo id="S3.E3.m1.12.12.12.7.3.2.2" xref="S3.E3.m1.12.12.12.7.3.1.cmml">,</mo><mi id="S3.E3.m1.12.12.12.5" xref="S3.E3.m1.12.12.12.5.cmml">j</mi><mo id="S3.E3.m1.12.12.12.7.3.2.3" stretchy="false" xref="S3.E3.m1.12.12.12.7.3.1.cmml">)</mo></mrow></mrow></mrow></mfrac><mo id="S3.E3.m1.27.27.1.1.4.1" xref="S3.E3.m1.27.27.1.1.4.1.cmml">⁢</mo><mrow id="S3.E3.m1.27.27.1.1.4.2" xref="S3.E3.m1.27.27.1.1.4.2c.cmml"><mtext id="S3.E3.m1.27.27.1.1.4.2a" xref="S3.E3.m1.27.27.1.1.4.2c.cmml">&nbsp;and&nbsp;</mtext><mtext id="S3.E3.m1.27.27.1.1.4.2b" xref="S3.E3.m1.27.27.1.1.4.2c.cmml">R</mtext></mrow><mo id="S3.E3.m1.27.27.1.1.4.1a" xref="S3.E3.m1.27.27.1.1.4.1.cmml">⁢</mo><mrow id="S3.E3.m1.27.27.1.1.4.3.2" xref="S3.E3.m1.27.27.1.1.4.cmml"><mo id="S3.E3.m1.27.27.1.1.4.3.2.1" stretchy="false" xref="S3.E3.m1.27.27.1.1.4.cmml">(</mo><mi id="S3.E3.m1.26.26" xref="S3.E3.m1.26.26.cmml">t</mi><mo id="S3.E3.m1.27.27.1.1.4.3.2.2" stretchy="false" xref="S3.E3.m1.27.27.1.1.4.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.27.27.1.1.5" xref="S3.E3.m1.27.27.1.1.5.cmml">=</mo><mfrac id="S3.E3.m1.24.24" xref="S3.E3.m1.24.24.cmml"><mrow id="S3.E3.m1.19.19.7" xref="S3.E3.m1.19.19.7.cmml"><mrow id="S3.E3.m1.19.19.7.9" xref="S3.E3.m1.19.19.7.9.cmml"><msub id="S3.E3.m1.19.19.7.9.1" xref="S3.E3.m1.19.19.7.9.1.cmml"><mo id="S3.E3.m1.19.19.7.9.1.2" xref="S3.E3.m1.19.19.7.9.1.2.cmml">∑</mo><mrow id="S3.E3.m1.15.15.3.3.3" xref="S3.E3.m1.15.15.3.3.3.cmml"><mrow id="S3.E3.m1.15.15.3.3.3.5.2" xref="S3.E3.m1.15.15.3.3.3.5.1.cmml"><mi id="S3.E3.m1.14.14.2.2.2.2" xref="S3.E3.m1.14.14.2.2.2.2.cmml">i</mi><mo id="S3.E3.m1.15.15.3.3.3.5.2.1" xref="S3.E3.m1.15.15.3.3.3.5.1.cmml">,</mo><mi id="S3.E3.m1.15.15.3.3.3.3" xref="S3.E3.m1.15.15.3.3.3.3.cmml">j</mi></mrow><mo id="S3.E3.m1.15.15.3.3.3.4" xref="S3.E3.m1.15.15.3.3.3.4.cmml">∈</mo><mrow id="S3.E3.m1.15.15.3.3.3.6" xref="S3.E3.m1.15.15.3.3.3.6.cmml"><mi id="S3.E3.m1.15.15.3.3.3.6.2" xref="S3.E3.m1.15.15.3.3.3.6.2.cmml">N</mi><mo id="S3.E3.m1.15.15.3.3.3.6.1" xref="S3.E3.m1.15.15.3.3.3.6.1.cmml">⁢</mo><mrow id="S3.E3.m1.15.15.3.3.3.6.3.2" xref="S3.E3.m1.15.15.3.3.3.6.cmml"><mo id="S3.E3.m1.15.15.3.3.3.6.3.2.1" stretchy="false" xref="S3.E3.m1.15.15.3.3.3.6.cmml">(</mo><mi id="S3.E3.m1.13.13.1.1.1.1" xref="S3.E3.m1.13.13.1.1.1.1.cmml">i</mi><mo id="S3.E3.m1.15.15.3.3.3.6.3.2.2" stretchy="false" xref="S3.E3.m1.15.15.3.3.3.6.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="S3.E3.m1.19.19.7.9.2" xref="S3.E3.m1.19.19.7.9.2.cmml"><msub id="S3.E3.m1.19.19.7.9.2.2" xref="S3.E3.m1.19.19.7.9.2.2.cmml"><mi id="S3.E3.m1.19.19.7.9.2.2.2" xref="S3.E3.m1.19.19.7.9.2.2.2.cmml">c</mi><mi id="S3.E3.m1.19.19.7.9.2.2.3" xref="S3.E3.m1.19.19.7.9.2.2.3.cmml">d</mi></msub><mo id="S3.E3.m1.19.19.7.9.2.1" xref="S3.E3.m1.19.19.7.9.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.19.19.7.9.2.3.2" xref="S3.E3.m1.19.19.7.9.2.3.1.cmml"><mo id="S3.E3.m1.19.19.7.9.2.3.2.1" stretchy="false" xref="S3.E3.m1.19.19.7.9.2.3.1.cmml">(</mo><mi id="S3.E3.m1.16.16.4.4" xref="S3.E3.m1.16.16.4.4.cmml">i</mi><mo id="S3.E3.m1.19.19.7.9.2.3.2.2" xref="S3.E3.m1.19.19.7.9.2.3.1.cmml">,</mo><mi id="S3.E3.m1.17.17.5.5" xref="S3.E3.m1.17.17.5.5.cmml">j</mi><mo id="S3.E3.m1.19.19.7.9.2.3.2.3" stretchy="false" xref="S3.E3.m1.19.19.7.9.2.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.19.19.7.8" xref="S3.E3.m1.19.19.7.8.cmml">∧</mo><mrow id="S3.E3.m1.19.19.7.10" xref="S3.E3.m1.19.19.7.10.cmml"><msub id="S3.E3.m1.19.19.7.10.2" xref="S3.E3.m1.19.19.7.10.2.cmml"><mi id="S3.E3.m1.19.19.7.10.2.2" xref="S3.E3.m1.19.19.7.10.2.2.cmml">c</mi><mover accent="true" id="S3.E3.m1.19.19.7.10.2.3" xref="S3.E3.m1.19.19.7.10.2.3.cmml"><mi id="S3.E3.m1.19.19.7.10.2.3.2" xref="S3.E3.m1.19.19.7.10.2.3.2.cmml">d</mi><mo id="S3.E3.m1.19.19.7.10.2.3.1" xref="S3.E3.m1.19.19.7.10.2.3.1.cmml">^</mo></mover></msub><mo id="S3.E3.m1.19.19.7.10.1" xref="S3.E3.m1.19.19.7.10.1.cmml">⁢</mo><mrow id="S3.E3.m1.19.19.7.10.3.2" xref="S3.E3.m1.19.19.7.10.3.1.cmml"><mo id="S3.E3.m1.19.19.7.10.3.2.1" stretchy="false" xref="S3.E3.m1.19.19.7.10.3.1.cmml">(</mo><mi id="S3.E3.m1.18.18.6.6" xref="S3.E3.m1.18.18.6.6.cmml">i</mi><mo id="S3.E3.m1.19.19.7.10.3.2.2" xref="S3.E3.m1.19.19.7.10.3.1.cmml">,</mo><mi id="S3.E3.m1.19.19.7.7" xref="S3.E3.m1.19.19.7.7.cmml">j</mi><mo id="S3.E3.m1.19.19.7.10.3.2.3" stretchy="false" xref="S3.E3.m1.19.19.7.10.3.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.E3.m1.24.24.12" xref="S3.E3.m1.24.24.12.cmml"><msub id="S3.E3.m1.24.24.12.6" xref="S3.E3.m1.24.24.12.6.cmml"><mo id="S3.E3.m1.24.24.12.6.2" xref="S3.E3.m1.24.24.12.6.2.cmml">∑</mo><mrow id="S3.E3.m1.22.22.10.3.3" xref="S3.E3.m1.22.22.10.3.3.cmml"><mrow id="S3.E3.m1.22.22.10.3.3.5.2" xref="S3.E3.m1.22.22.10.3.3.5.1.cmml"><mi id="S3.E3.m1.21.21.9.2.2.2" xref="S3.E3.m1.21.21.9.2.2.2.cmml">i</mi><mo id="S3.E3.m1.22.22.10.3.3.5.2.1" xref="S3.E3.m1.22.22.10.3.3.5.1.cmml">,</mo><mi id="S3.E3.m1.22.22.10.3.3.3" xref="S3.E3.m1.22.22.10.3.3.3.cmml">j</mi></mrow><mo id="S3.E3.m1.22.22.10.3.3.4" xref="S3.E3.m1.22.22.10.3.3.4.cmml">∈</mo><mrow id="S3.E3.m1.22.22.10.3.3.6" xref="S3.E3.m1.22.22.10.3.3.6.cmml"><mi id="S3.E3.m1.22.22.10.3.3.6.2" xref="S3.E3.m1.22.22.10.3.3.6.2.cmml">N</mi><mo id="S3.E3.m1.22.22.10.3.3.6.1" xref="S3.E3.m1.22.22.10.3.3.6.1.cmml">⁢</mo><mrow id="S3.E3.m1.22.22.10.3.3.6.3.2" xref="S3.E3.m1.22.22.10.3.3.6.cmml"><mo id="S3.E3.m1.22.22.10.3.3.6.3.2.1" stretchy="false" xref="S3.E3.m1.22.22.10.3.3.6.cmml">(</mo><mi id="S3.E3.m1.20.20.8.1.1.1" xref="S3.E3.m1.20.20.8.1.1.1.cmml">i</mi><mo id="S3.E3.m1.22.22.10.3.3.6.3.2.2" stretchy="false" xref="S3.E3.m1.22.22.10.3.3.6.cmml">)</mo></mrow></mrow></mrow></msub><mrow id="S3.E3.m1.24.24.12.7" xref="S3.E3.m1.24.24.12.7.cmml"><msub id="S3.E3.m1.24.24.12.7.2" xref="S3.E3.m1.24.24.12.7.2.cmml"><mi id="S3.E3.m1.24.24.12.7.2.2" xref="S3.E3.m1.24.24.12.7.2.2.cmml">c</mi><mover accent="true" id="S3.E3.m1.24.24.12.7.2.3" xref="S3.E3.m1.24.24.12.7.2.3.cmml"><mi id="S3.E3.m1.24.24.12.7.2.3.2" xref="S3.E3.m1.24.24.12.7.2.3.2.cmml">d</mi><mo id="S3.E3.m1.24.24.12.7.2.3.1" xref="S3.E3.m1.24.24.12.7.2.3.1.cmml">^</mo></mover></msub><mo id="S3.E3.m1.24.24.12.7.1" xref="S3.E3.m1.24.24.12.7.1.cmml">⁢</mo><mrow id="S3.E3.m1.24.24.12.7.3.2" xref="S3.E3.m1.24.24.12.7.3.1.cmml"><mo id="S3.E3.m1.24.24.12.7.3.2.1" stretchy="false" xref="S3.E3.m1.24.24.12.7.3.1.cmml">(</mo><mi id="S3.E3.m1.23.23.11.4" xref="S3.E3.m1.23.23.11.4.cmml">i</mi><mo id="S3.E3.m1.24.24.12.7.3.2.2" xref="S3.E3.m1.24.24.12.7.3.1.cmml">,</mo><mi id="S3.E3.m1.24.24.12.5" xref="S3.E3.m1.24.24.12.5.cmml">j</mi><mo id="S3.E3.m1.24.24.12.7.3.2.3" stretchy="false" xref="S3.E3.m1.24.24.12.7.3.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E3.m1.27.27.1.2" lspace="0em" xref="S3.E3.m1.27.27.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.27b"><apply id="S3.E3.m1.27.27.1.1.cmml" xref="S3.E3.m1.27.27.1"><and id="S3.E3.m1.27.27.1.1a.cmml" xref="S3.E3.m1.27.27.1"></and><apply id="S3.E3.m1.27.27.1.1b.cmml" xref="S3.E3.m1.27.27.1"><eq id="S3.E3.m1.27.27.1.1.3.cmml" xref="S3.E3.m1.27.27.1.1.3"></eq><apply id="S3.E3.m1.27.27.1.1.2.cmml" xref="S3.E3.m1.27.27.1.1.2"><times id="S3.E3.m1.27.27.1.1.2.1.cmml" xref="S3.E3.m1.27.27.1.1.2.1"></times><ci id="S3.E3.m1.27.27.1.1.2.2a.cmml" xref="S3.E3.m1.27.27.1.1.2.2"><mtext id="S3.E3.m1.27.27.1.1.2.2.cmml" xref="S3.E3.m1.27.27.1.1.2.2">P</mtext></ci><ci id="S3.E3.m1.25.25.cmml" xref="S3.E3.m1.25.25">𝑡</ci></apply><apply id="S3.E3.m1.27.27.1.1.4.cmml" xref="S3.E3.m1.27.27.1.1.4"><times id="S3.E3.m1.27.27.1.1.4.1.cmml" xref="S3.E3.m1.27.27.1.1.4.1"></times><apply id="S3.E3.m1.12.12.cmml" xref="S3.E3.m1.12.12"><divide id="S3.E3.m1.12.12.13.cmml" xref="S3.E3.m1.12.12"></divide><apply id="S3.E3.m1.7.7.7.cmml" xref="S3.E3.m1.7.7.7"><and id="S3.E3.m1.7.7.7.8.cmml" xref="S3.E3.m1.7.7.7.8"></and><apply id="S3.E3.m1.7.7.7.9.cmml" xref="S3.E3.m1.7.7.7.9"><apply id="S3.E3.m1.7.7.7.9.1.cmml" xref="S3.E3.m1.7.7.7.9.1"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.9.1.1.cmml" xref="S3.E3.m1.7.7.7.9.1">subscript</csymbol><sum id="S3.E3.m1.7.7.7.9.1.2.cmml" xref="S3.E3.m1.7.7.7.9.1.2"></sum><apply id="S3.E3.m1.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3"><in id="S3.E3.m1.3.3.3.3.3.4.cmml" xref="S3.E3.m1.3.3.3.3.3.4"></in><list id="S3.E3.m1.3.3.3.3.3.5.1.cmml" xref="S3.E3.m1.3.3.3.3.3.5.2"><ci id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2">𝑖</ci><ci id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3">𝑗</ci></list><apply id="S3.E3.m1.3.3.3.3.3.6.cmml" xref="S3.E3.m1.3.3.3.3.3.6"><times id="S3.E3.m1.3.3.3.3.3.6.1.cmml" xref="S3.E3.m1.3.3.3.3.3.6.1"></times><ci id="S3.E3.m1.3.3.3.3.3.6.2.cmml" xref="S3.E3.m1.3.3.3.3.3.6.2">𝑁</ci><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.7.7.7.9.2.cmml" xref="S3.E3.m1.7.7.7.9.2"><times id="S3.E3.m1.7.7.7.9.2.1.cmml" xref="S3.E3.m1.7.7.7.9.2.1"></times><apply id="S3.E3.m1.7.7.7.9.2.2.cmml" xref="S3.E3.m1.7.7.7.9.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.9.2.2.1.cmml" xref="S3.E3.m1.7.7.7.9.2.2">subscript</csymbol><ci id="S3.E3.m1.7.7.7.9.2.2.2.cmml" xref="S3.E3.m1.7.7.7.9.2.2.2">𝑐</ci><ci id="S3.E3.m1.7.7.7.9.2.2.3.cmml" xref="S3.E3.m1.7.7.7.9.2.2.3">𝑑</ci></apply><interval closure="open" id="S3.E3.m1.7.7.7.9.2.3.1.cmml" xref="S3.E3.m1.7.7.7.9.2.3.2"><ci id="S3.E3.m1.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4">𝑖</ci><ci id="S3.E3.m1.5.5.5.5.cmml" xref="S3.E3.m1.5.5.5.5">𝑗</ci></interval></apply></apply><apply id="S3.E3.m1.7.7.7.10.cmml" xref="S3.E3.m1.7.7.7.10"><times id="S3.E3.m1.7.7.7.10.1.cmml" xref="S3.E3.m1.7.7.7.10.1"></times><apply id="S3.E3.m1.7.7.7.10.2.cmml" xref="S3.E3.m1.7.7.7.10.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.10.2.1.cmml" xref="S3.E3.m1.7.7.7.10.2">subscript</csymbol><ci id="S3.E3.m1.7.7.7.10.2.2.cmml" xref="S3.E3.m1.7.7.7.10.2.2">𝑐</ci><apply id="S3.E3.m1.7.7.7.10.2.3.cmml" xref="S3.E3.m1.7.7.7.10.2.3"><ci id="S3.E3.m1.7.7.7.10.2.3.1.cmml" xref="S3.E3.m1.7.7.7.10.2.3.1">^</ci><ci id="S3.E3.m1.7.7.7.10.2.3.2.cmml" xref="S3.E3.m1.7.7.7.10.2.3.2">𝑑</ci></apply></apply><interval closure="open" id="S3.E3.m1.7.7.7.10.3.1.cmml" xref="S3.E3.m1.7.7.7.10.3.2"><ci id="S3.E3.m1.6.6.6.6.cmml" xref="S3.E3.m1.6.6.6.6">𝑖</ci><ci id="S3.E3.m1.7.7.7.7.cmml" xref="S3.E3.m1.7.7.7.7">𝑗</ci></interval></apply></apply><apply id="S3.E3.m1.12.12.12.cmml" xref="S3.E3.m1.12.12.12"><apply id="S3.E3.m1.12.12.12.6.cmml" xref="S3.E3.m1.12.12.12.6"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.12.6.1.cmml" xref="S3.E3.m1.12.12.12.6">subscript</csymbol><sum id="S3.E3.m1.12.12.12.6.2.cmml" xref="S3.E3.m1.12.12.12.6.2"></sum><apply id="S3.E3.m1.10.10.10.3.3.cmml" xref="S3.E3.m1.10.10.10.3.3"><in id="S3.E3.m1.10.10.10.3.3.4.cmml" xref="S3.E3.m1.10.10.10.3.3.4"></in><list id="S3.E3.m1.10.10.10.3.3.5.1.cmml" xref="S3.E3.m1.10.10.10.3.3.5.2"><ci id="S3.E3.m1.9.9.9.2.2.2.cmml" xref="S3.E3.m1.9.9.9.2.2.2">𝑖</ci><ci id="S3.E3.m1.10.10.10.3.3.3.cmml" xref="S3.E3.m1.10.10.10.3.3.3">𝑗</ci></list><apply id="S3.E3.m1.10.10.10.3.3.6.cmml" xref="S3.E3.m1.10.10.10.3.3.6"><times id="S3.E3.m1.10.10.10.3.3.6.1.cmml" xref="S3.E3.m1.10.10.10.3.3.6.1"></times><ci id="S3.E3.m1.10.10.10.3.3.6.2.cmml" xref="S3.E3.m1.10.10.10.3.3.6.2">𝑁</ci><ci id="S3.E3.m1.8.8.8.1.1.1.cmml" xref="S3.E3.m1.8.8.8.1.1.1">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.12.12.12.7.cmml" xref="S3.E3.m1.12.12.12.7"><times id="S3.E3.m1.12.12.12.7.1.cmml" xref="S3.E3.m1.12.12.12.7.1"></times><apply id="S3.E3.m1.12.12.12.7.2.cmml" xref="S3.E3.m1.12.12.12.7.2"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.12.7.2.1.cmml" xref="S3.E3.m1.12.12.12.7.2">subscript</csymbol><ci id="S3.E3.m1.12.12.12.7.2.2.cmml" xref="S3.E3.m1.12.12.12.7.2.2">𝑐</ci><ci id="S3.E3.m1.12.12.12.7.2.3.cmml" xref="S3.E3.m1.12.12.12.7.2.3">𝑑</ci></apply><interval closure="open" id="S3.E3.m1.12.12.12.7.3.1.cmml" xref="S3.E3.m1.12.12.12.7.3.2"><ci id="S3.E3.m1.11.11.11.4.cmml" xref="S3.E3.m1.11.11.11.4">𝑖</ci><ci id="S3.E3.m1.12.12.12.5.cmml" xref="S3.E3.m1.12.12.12.5">𝑗</ci></interval></apply></apply></apply><ci id="S3.E3.m1.27.27.1.1.4.2c.cmml" xref="S3.E3.m1.27.27.1.1.4.2"><mrow id="S3.E3.m1.27.27.1.1.4.2.cmml" xref="S3.E3.m1.27.27.1.1.4.2"><mtext id="S3.E3.m1.27.27.1.1.4.2a.cmml" xref="S3.E3.m1.27.27.1.1.4.2">&nbsp;and&nbsp;</mtext><mtext id="S3.E3.m1.27.27.1.1.4.2b.cmml" xref="S3.E3.m1.27.27.1.1.4.2">R</mtext></mrow></ci><ci id="S3.E3.m1.26.26.cmml" xref="S3.E3.m1.26.26">𝑡</ci></apply></apply><apply id="S3.E3.m1.27.27.1.1c.cmml" xref="S3.E3.m1.27.27.1"><eq id="S3.E3.m1.27.27.1.1.5.cmml" xref="S3.E3.m1.27.27.1.1.5"></eq><share href="https://arxiv.org/html/2410.02073v1#S3.E3.m1.27.27.1.1.4.cmml" id="S3.E3.m1.27.27.1.1d.cmml" xref="S3.E3.m1.27.27.1"></share><apply id="S3.E3.m1.24.24.cmml" xref="S3.E3.m1.24.24"><divide id="S3.E3.m1.24.24.13.cmml" xref="S3.E3.m1.24.24"></divide><apply id="S3.E3.m1.19.19.7.cmml" xref="S3.E3.m1.19.19.7"><and id="S3.E3.m1.19.19.7.8.cmml" xref="S3.E3.m1.19.19.7.8"></and><apply id="S3.E3.m1.19.19.7.9.cmml" xref="S3.E3.m1.19.19.7.9"><apply id="S3.E3.m1.19.19.7.9.1.cmml" xref="S3.E3.m1.19.19.7.9.1"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.7.9.1.1.cmml" xref="S3.E3.m1.19.19.7.9.1">subscript</csymbol><sum id="S3.E3.m1.19.19.7.9.1.2.cmml" xref="S3.E3.m1.19.19.7.9.1.2"></sum><apply id="S3.E3.m1.15.15.3.3.3.cmml" xref="S3.E3.m1.15.15.3.3.3"><in id="S3.E3.m1.15.15.3.3.3.4.cmml" xref="S3.E3.m1.15.15.3.3.3.4"></in><list id="S3.E3.m1.15.15.3.3.3.5.1.cmml" xref="S3.E3.m1.15.15.3.3.3.5.2"><ci id="S3.E3.m1.14.14.2.2.2.2.cmml" xref="S3.E3.m1.14.14.2.2.2.2">𝑖</ci><ci id="S3.E3.m1.15.15.3.3.3.3.cmml" xref="S3.E3.m1.15.15.3.3.3.3">𝑗</ci></list><apply id="S3.E3.m1.15.15.3.3.3.6.cmml" xref="S3.E3.m1.15.15.3.3.3.6"><times id="S3.E3.m1.15.15.3.3.3.6.1.cmml" xref="S3.E3.m1.15.15.3.3.3.6.1"></times><ci id="S3.E3.m1.15.15.3.3.3.6.2.cmml" xref="S3.E3.m1.15.15.3.3.3.6.2">𝑁</ci><ci id="S3.E3.m1.13.13.1.1.1.1.cmml" xref="S3.E3.m1.13.13.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.19.19.7.9.2.cmml" xref="S3.E3.m1.19.19.7.9.2"><times id="S3.E3.m1.19.19.7.9.2.1.cmml" xref="S3.E3.m1.19.19.7.9.2.1"></times><apply id="S3.E3.m1.19.19.7.9.2.2.cmml" xref="S3.E3.m1.19.19.7.9.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.7.9.2.2.1.cmml" xref="S3.E3.m1.19.19.7.9.2.2">subscript</csymbol><ci id="S3.E3.m1.19.19.7.9.2.2.2.cmml" xref="S3.E3.m1.19.19.7.9.2.2.2">𝑐</ci><ci id="S3.E3.m1.19.19.7.9.2.2.3.cmml" xref="S3.E3.m1.19.19.7.9.2.2.3">𝑑</ci></apply><interval closure="open" id="S3.E3.m1.19.19.7.9.2.3.1.cmml" xref="S3.E3.m1.19.19.7.9.2.3.2"><ci id="S3.E3.m1.16.16.4.4.cmml" xref="S3.E3.m1.16.16.4.4">𝑖</ci><ci id="S3.E3.m1.17.17.5.5.cmml" xref="S3.E3.m1.17.17.5.5">𝑗</ci></interval></apply></apply><apply id="S3.E3.m1.19.19.7.10.cmml" xref="S3.E3.m1.19.19.7.10"><times id="S3.E3.m1.19.19.7.10.1.cmml" xref="S3.E3.m1.19.19.7.10.1"></times><apply id="S3.E3.m1.19.19.7.10.2.cmml" xref="S3.E3.m1.19.19.7.10.2"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.7.10.2.1.cmml" xref="S3.E3.m1.19.19.7.10.2">subscript</csymbol><ci id="S3.E3.m1.19.19.7.10.2.2.cmml" xref="S3.E3.m1.19.19.7.10.2.2">𝑐</ci><apply id="S3.E3.m1.19.19.7.10.2.3.cmml" xref="S3.E3.m1.19.19.7.10.2.3"><ci id="S3.E3.m1.19.19.7.10.2.3.1.cmml" xref="S3.E3.m1.19.19.7.10.2.3.1">^</ci><ci id="S3.E3.m1.19.19.7.10.2.3.2.cmml" xref="S3.E3.m1.19.19.7.10.2.3.2">𝑑</ci></apply></apply><interval closure="open" id="S3.E3.m1.19.19.7.10.3.1.cmml" xref="S3.E3.m1.19.19.7.10.3.2"><ci id="S3.E3.m1.18.18.6.6.cmml" xref="S3.E3.m1.18.18.6.6">𝑖</ci><ci id="S3.E3.m1.19.19.7.7.cmml" xref="S3.E3.m1.19.19.7.7">𝑗</ci></interval></apply></apply><apply id="S3.E3.m1.24.24.12.cmml" xref="S3.E3.m1.24.24.12"><apply id="S3.E3.m1.24.24.12.6.cmml" xref="S3.E3.m1.24.24.12.6"><csymbol cd="ambiguous" id="S3.E3.m1.24.24.12.6.1.cmml" xref="S3.E3.m1.24.24.12.6">subscript</csymbol><sum id="S3.E3.m1.24.24.12.6.2.cmml" xref="S3.E3.m1.24.24.12.6.2"></sum><apply id="S3.E3.m1.22.22.10.3.3.cmml" xref="S3.E3.m1.22.22.10.3.3"><in id="S3.E3.m1.22.22.10.3.3.4.cmml" xref="S3.E3.m1.22.22.10.3.3.4"></in><list id="S3.E3.m1.22.22.10.3.3.5.1.cmml" xref="S3.E3.m1.22.22.10.3.3.5.2"><ci id="S3.E3.m1.21.21.9.2.2.2.cmml" xref="S3.E3.m1.21.21.9.2.2.2">𝑖</ci><ci id="S3.E3.m1.22.22.10.3.3.3.cmml" xref="S3.E3.m1.22.22.10.3.3.3">𝑗</ci></list><apply id="S3.E3.m1.22.22.10.3.3.6.cmml" xref="S3.E3.m1.22.22.10.3.3.6"><times id="S3.E3.m1.22.22.10.3.3.6.1.cmml" xref="S3.E3.m1.22.22.10.3.3.6.1"></times><ci id="S3.E3.m1.22.22.10.3.3.6.2.cmml" xref="S3.E3.m1.22.22.10.3.3.6.2">𝑁</ci><ci id="S3.E3.m1.20.20.8.1.1.1.cmml" xref="S3.E3.m1.20.20.8.1.1.1">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.24.24.12.7.cmml" xref="S3.E3.m1.24.24.12.7"><times id="S3.E3.m1.24.24.12.7.1.cmml" xref="S3.E3.m1.24.24.12.7.1"></times><apply id="S3.E3.m1.24.24.12.7.2.cmml" xref="S3.E3.m1.24.24.12.7.2"><csymbol cd="ambiguous" id="S3.E3.m1.24.24.12.7.2.1.cmml" xref="S3.E3.m1.24.24.12.7.2">subscript</csymbol><ci id="S3.E3.m1.24.24.12.7.2.2.cmml" xref="S3.E3.m1.24.24.12.7.2.2">𝑐</ci><apply id="S3.E3.m1.24.24.12.7.2.3.cmml" xref="S3.E3.m1.24.24.12.7.2.3"><ci id="S3.E3.m1.24.24.12.7.2.3.1.cmml" xref="S3.E3.m1.24.24.12.7.2.3.1">^</ci><ci id="S3.E3.m1.24.24.12.7.2.3.2.cmml" xref="S3.E3.m1.24.24.12.7.2.3.2">𝑑</ci></apply></apply><interval closure="open" id="S3.E3.m1.24.24.12.7.3.1.cmml" xref="S3.E3.m1.24.24.12.7.3.2"><ci id="S3.E3.m1.23.23.11.4.cmml" xref="S3.E3.m1.23.23.11.4">𝑖</ci><ci id="S3.E3.m1.24.24.12.5.cmml" xref="S3.E3.m1.24.24.12.5">𝑗</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.27c">\text{P}(t)=\frac{\sum_{i,j\in N(i)}c_{d}(i,j)\wedge c_{\hat{d}}(i,j)}{\sum_{i% ,j\in N(i)}c_{d}(i,j)}\text{ and }\text{R}(t)=\frac{\sum_{i,j\in N(i)}c_{d}(i,% j)\wedge c_{\hat{d}}(i,j)}{\sum_{i,j\in N(i)}c_{\hat{d}}(i,j)}.</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.27d">P ( italic_t ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i , italic_j ∈ italic_N ( italic_i ) end_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( italic_i , italic_j ) ∧ italic_c start_POSTSUBSCRIPT over^ start_ARG italic_d end_ARG end_POSTSUBSCRIPT ( italic_i , italic_j ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i , italic_j ∈ italic_N ( italic_i ) end_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( italic_i , italic_j ) end_ARG and roman_R ( italic_t ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i , italic_j ∈ italic_N ( italic_i ) end_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( italic_i , italic_j ) ∧ italic_c start_POSTSUBSCRIPT over^ start_ARG italic_d end_ARG end_POSTSUBSCRIPT ( italic_i , italic_j ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i , italic_j ∈ italic_N ( italic_i ) end_POSTSUBSCRIPT italic_c start_POSTSUBSCRIPT over^ start_ARG italic_d end_ARG end_POSTSUBSCRIPT ( italic_i , italic_j ) end_ARG .</annotation></semantics></math></td><td></td><td rowspan="1"><span>(3)</span></td></tr></tbody></table>

Note that both P𝑃Pitalic\_P and R𝑅Ritalic\_R are scale-invariant. In our experiments, we report the F1 score. To account for multiple relative depth ratios, we further perform a weighted averaging of the F1 values with thresholds that range linearly from tm⁢i⁢n\=5subscript𝑡𝑚𝑖𝑛5t\_{min}=5italic\_t start\_POSTSUBSCRIPT italic\_m italic\_i italic\_n end\_POSTSUBSCRIPT = 5 to tm⁢a⁢x\=25subscript𝑡𝑚𝑎𝑥25t\_{max}=25italic\_t start\_POSTSUBSCRIPT italic\_m italic\_a italic\_x end\_POSTSUBSCRIPT = 25, with stronger weights towards high threshold values. Compared to other edge-based metrics (such as the edge accuracy and completion from iBims (Koch et al., [2018](https://arxiv.org/html/2410.02073v1#bib.bib50))), our metric does not require any manual edge annotation, but simply pixelwise ground truth, which is easily obtained for synthetic datasets.

Similarly, we can also identify occluding contours from binary label maps that can be derived from real-world segmentation, saliency, and matting datasets. Given a binary mask b𝑏bitalic\_b over the image, we define the presence of an occluding contour cbsubscript𝑐𝑏c\_{b}italic\_c start\_POSTSUBSCRIPT italic\_b end\_POSTSUBSCRIPT between pixels i,j𝑖𝑗i,jitalic\_i , italic\_j as cb⁢(i,j)\=b⁢(i)∧¬b⁢(j)subscript𝑐𝑏𝑖𝑗𝑏𝑖𝑏𝑗c\_{b}(i,j)=b(i)\\land\\lnot b(j)italic\_c start\_POSTSUBSCRIPT italic\_b end\_POSTSUBSCRIPT ( italic\_i , italic\_j ) = italic\_b ( italic\_i ) ∧ ¬ italic\_b ( italic\_j ). With this definition at hand, we compute the recall R⁢(t)R𝑡\\text{R}(t)R ( italic\_t ) by replacing the occluding contours from depth maps in Eq. [3](https://arxiv.org/html/2410.02073v1#S3.E3 "In Evaluation metrics for sharp boundaries. ‣ 3.2 Sharp monocular depth estimation ‣ 3 Method ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") with those from binary maps. Since the binary maps commonly label whole objects, we cannot obtain ground-truth occluding contours that do not align with object silhouettes. Thus the boundary annotation is incomplete – some but not all occluding contours are identified by this procedure. Therefore we can only compute the recall but not the precision for binary maps.

To penalize blurry edges, we suppress non-maximum values of cd^subscript𝑐^𝑑c\_{\\hat{d}}italic\_c start\_POSTSUBSCRIPT over^ start\_ARG italic\_d end\_ARG end\_POSTSUBSCRIPT within the valid bounds of cd^⁢(i,j)subscript𝑐^𝑑𝑖𝑗c\_{\\hat{d}}(i,j)italic\_c start\_POSTSUBSCRIPT over^ start\_ARG italic\_d end\_ARG end\_POSTSUBSCRIPT ( italic\_i , italic\_j ) connected components. For additional experiments and qualitative results we refer to the appendices.

### 3.3 Focal length estimation

To handle images that may have inaccurate or missing EXIF metadata, we supplement our network with a focal length estimation head. A small convolutional head ingests frozen features from the depth estimation network and task-specific features from a separate ViT image encoder to predict the horizontal angular field-of-view. We use ℒ2subscriptℒ2\\mathcal{L}\_{2}caligraphic\_L start\_POSTSUBSCRIPT 2 end\_POSTSUBSCRIPT as the training loss. We train the focal length head and the ViT encoder after the depth estimation training. Separating the focal length training has several benefits over joint training with the depth network. It avoids the necessity of balancing the depth and focal length training objectives. It also allows training the focal length head on a different set of datasets, excluding some narrow-domain single-camera datasets that are used in training the depth estimation network, and adding large-scale image datasets that provide focal length supervision but no depth supervision. Further details are provided in the appendices.

## 4 Experiments

This section summarizes the key results. Additional details and experiments are reported in the appendices, including details on datasets, hyperparameters, experimental protocols, and the comparison of runtimes, which is summarized in Fig. [2](https://arxiv.org/html/2410.02073v1#S1.F2 "Figure 2 ‣ 1 Introduction ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second"). The appendices also report controlled experiments, including controlled studies on network architectures, training objectives, and training curricula.

Here we summarize a number of key comparisons of Depth Pro to state-of-the-art metric monocular depth estimation systems. One challenge in conducting such a comparison is that many leading recent systems are trained on bespoke combinations of datasets. Some systems use proprietary datasets that are not publicly available, and some use datasets that are only available under restrictive licenses. Some recent systems also train on unlabeled datasets or incorporate pretrained models (e.g., diffusion models) that were trained on additional massive datasets. This rules out the possibility of a comparison that controls for training data (e.g., only comparing to systems that use the same datasets we do). At this stage of this research area, the only feasible comparison to other leading cross-domain monocular depth estimation models is on a full system-to-system basis. Fully trained models (each trained on a large, partially overlapping and partially distinct collection of datasets) are compared to each other zero-shot on datasets that none of the compared systems trained on.

Zero-shot metric depth. We evaluate our method’s ability to predict zero-shot _metric_ depth and compare against the state of the art in Tab. [1](https://arxiv.org/html/2410.02073v1#S4.T1 "Table 1 ‣ 4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second"). Our baselines include Depth Anything (Yang et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib112)), Metric3D (Yin et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib116)), PatchFusion (Li et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib61)), UniDepth (Piccinelli et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib76)), ZeroDepth (Guizilini et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib35)) and ZoeDepth (Bhat et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib6)). We also report results for the very recent Depth Anything v2 (Yang et al., [2024b](https://arxiv.org/html/2410.02073v1#bib.bib113)) and Metric3D v2 (Hu et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib38)).

As an overall summary measure of metric depth accuracy, Tab. [1](https://arxiv.org/html/2410.02073v1#S4.T1 "Table 1 ‣ 4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") uses the δ1subscript𝛿1\\delta\_{1}italic\_δ start\_POSTSUBSCRIPT 1 end\_POSTSUBSCRIPT metric (Ladicky et al., [2014](https://arxiv.org/html/2410.02073v1#bib.bib52)), which is commonly used for this purpose (Yin et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib116); Yang et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib112); Piccinelli et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib76)). It is defined as the percentage of inlier pixels, for which the predicted and ground-truth depths are within 25% of each other. We picked this metric for its robustness, with the strictest threshold found in the literature (25%percent2525\\%25 %).

Corresponding tables for additional metrics can be found in Sec. [A.2](https://arxiv.org/html/2410.02073v1#A1.SS2 "A.2 Zero-shot metric depth ‣ Appendix A Additional Results ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") of the appendices, including 𝐴𝑏𝑠𝑅𝑒𝑙𝐴𝑏𝑠𝑅𝑒𝑙\\mathit{AbsRel}italic\_AbsRel (Ladicky et al., [2014](https://arxiv.org/html/2410.02073v1#bib.bib52)), 𝐿𝑜𝑔10subscript𝐿𝑜𝑔10\\mathit{Log}\_{10}italic\_Log start\_POSTSUBSCRIPT 10 end\_POSTSUBSCRIPT, δ2subscript𝛿2\\delta\_{2}italic\_δ start\_POSTSUBSCRIPT 2 end\_POSTSUBSCRIPT and δ3subscript𝛿3\\delta\_{3}italic\_δ start\_POSTSUBSCRIPT 3 end\_POSTSUBSCRIPT scores, as well as point-cloud metrics (Spencer et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib93)). Tab. [1](https://arxiv.org/html/2410.02073v1#S4.T1 "Table 1 ‣ 4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") also reports the average rank of each method across datasets, a common way to summarize cross-dataset performance (Ranftl et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib83)).

We report results on Booster (Ramirez et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib81)), Middlebury (Scharstein et al., [2014](https://arxiv.org/html/2410.02073v1#bib.bib88)), Sun-RGBD (Song et al., [2015](https://arxiv.org/html/2410.02073v1#bib.bib92)), ETH3D (Schöps et al., [2017](https://arxiv.org/html/2410.02073v1#bib.bib89)), nuScenes (Caesar et al., [2020](https://arxiv.org/html/2410.02073v1#bib.bib11)), and Sintel (Butler et al., [2012](https://arxiv.org/html/2410.02073v1#bib.bib9)), because, to our knowledge, they were never used in training any of the evaluated systems. Despite our best efforts, we were not able to run ZeroDepth on Booster, Middlebury, or Sun-RGBD as it consistently ran out of memory due to the high image resolutions. More details on our evaluation setup can be found in Sec. [C](https://arxiv.org/html/2410.02073v1#A3 "Appendix C Implementation, Training and Evaluation Details ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") of the appendix.

The results in Tab. [1](https://arxiv.org/html/2410.02073v1#S4.T1 "Table 1 ‣ 4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") confirm the findings of Piccinelli et al. ([2024](https://arxiv.org/html/2410.02073v1#bib.bib76)), who observed considerable domain bias in some of the leading metric depth estimation models. Notably, Depth Anything v1 & v2 focus on _relative_ depth estimation; for metric depth, they provide different models for different domains, fine-tuned either for indoor or for outdoor scenes. Metric3D v1 & v2 provide domain-invariant models, but their performance depends strongly on careful selection of the crop size at test time, which is performed _per domain_ in their experiments and thus violates the zero-shot premise. We tried setting the crop size automatically based on the aspect ratio of the image, but this substantially degraded the performance of Metric3D; for this reason, we use the recommended non-zero-shot protocol, with the recommended per-domain crop sizes. Since domain-specific models and crop sizes violate the strict zero-shot premise we (and other baselines) operate under, we mark the Depth Anything and Metric3D results in gray in Tab. [1](https://arxiv.org/html/2410.02073v1#S4.T1 "Table 1 ‣ 4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second").

We find that Depth Pro demonstrates the strongest generalization by consistently scoring among the top approaches per dataset and obtaining the best average rank across all datasets.

Table 1: Zero-shot metric depth accuracy. We report the δ1subscript𝛿1\\delta\_{1}italic\_δ start\_POSTSUBSCRIPT 1 end\_POSTSUBSCRIPT score per dataset (higher is better) and aggregate performance across datasets via the average rank (lower is better). Methods in gray are not strictly zero-shot. Results on additional metrics and datasets are presented in the appendices.

Table 2: Zero-shot boundary accuracy. We report the F1 score for dataset with ground-truth depth, and boundary recall (R𝑅Ritalic\_R) for matting and segmentation datasets. Qualitative results are shown on a sample from the AM-2k dataset (Li et al., [2022a](https://arxiv.org/html/2410.02073v1#bib.bib56)). Higher is better for all metrics.

<table id="S4.T2.14"><tbody><tr id="S4.T2.14.6"><td id="S4.T2.9.1.1"><img alt="[Uncaptioned image]" height="120" id="S4.T2.9.1.1.g1" src="chrome-extension://pcmpcfapbekmbjjkdalcgopdkipoggdi/html/2410.02073v1/x4.png" width="120"></td><td id="S4.T2.10.2.2"><img alt="[Uncaptioned image]" height="120" id="S4.T2.10.2.2.g1" src="chrome-extension://pcmpcfapbekmbjjkdalcgopdkipoggdi/html/2410.02073v1/x5.png" width="120"></td><td id="S4.T2.11.3.3"><img alt="[Uncaptioned image]" height="120" id="S4.T2.11.3.3.g1" src="chrome-extension://pcmpcfapbekmbjjkdalcgopdkipoggdi/html/2410.02073v1/x6.png" width="120"></td><td id="S4.T2.12.4.4"><img alt="[Uncaptioned image]" height="120" id="S4.T2.12.4.4.g1" src="chrome-extension://pcmpcfapbekmbjjkdalcgopdkipoggdi/html/2410.02073v1/x7.png" width="120"></td><td id="S4.T2.13.5.5"><img alt="[Uncaptioned image]" height="120" id="S4.T2.13.5.5.g1" src="chrome-extension://pcmpcfapbekmbjjkdalcgopdkipoggdi/html/2410.02073v1/x8.png" width="120"></td><td id="S4.T2.14.6.6"><img alt="[Uncaptioned image]" height="120" id="S4.T2.14.6.6.g1" src="chrome-extension://pcmpcfapbekmbjjkdalcgopdkipoggdi/html/2410.02073v1/x9.png" width="120"></td></tr><tr id="S4.T2.14.7.1"><td id="S4.T2.14.7.1.1">Image</td><td id="S4.T2.14.7.1.2">Alpha Matte</td><td id="S4.T2.14.7.1.3">Depth Pro (Ours)</td><td id="S4.T2.14.7.1.4">DepthAnything v2</td><td id="S4.T2.14.7.1.5">PatchFusion</td><td id="S4.T2.14.7.1.6">Marigold</td></tr></tbody></table>

Zero-shot boundaries. Tab. [2](https://arxiv.org/html/2410.02073v1#S4.T2 "Table 2 ‣ 4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") summarizes the evaluation of boundary accuracy for Depth Pro and a number of baselines. This evaluation is conducted in a zero-shot setting: models are only evaluated on datasets that were not seen during training. Since our boundary metrics are scale-invariant, our baselines here also include methods that only predict relative (rather than absolute metric) depth. Our absolute baselines include Metric3D (Yin et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib116)), Metric3D v2 (‘giant’ model) (Hu et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib38)), PatchFusion (Li et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib61)), UniDepth (Piccinelli et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib76)), and ZoeDepth (Bhat et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib6)). We also report results for the relative variants of Depth Anything v1 & v2 (Yang et al., [2024a](https://arxiv.org/html/2410.02073v1#bib.bib112); [b](https://arxiv.org/html/2410.02073v1#bib.bib113)) because they yield sharper boundaries than their metric counterparts. Lastly, we include Marigold (Ke et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib45)), a recent diffusion-based relative depth model that became popular due to its high-fidelity predictions. We use the boundary metrics introduced in Sec. [3.2](https://arxiv.org/html/2410.02073v1#S3.SS2.SSS0.Px3 "Evaluation metrics for sharp boundaries. ‣ 3.2 Sharp monocular depth estimation ‣ 3 Method ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second"), and report the average boundary F1 score for datasets with ground-truth depth, and boundary recall (R𝑅Ritalic\_R) for datasets with matting or segmentation annotations. For image matting datasets, a pixel is marked as occluding when the value of the alpha matte is above 0.10.10.10.1.

The datasets include Sintel (Butler et al., [2012](https://arxiv.org/html/2410.02073v1#bib.bib9)) and Spring (Mehl et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib68)), which are synthetic. We also include the iBims dataset (Koch et al., [2018](https://arxiv.org/html/2410.02073v1#bib.bib50)) which is often used specifically to evaluate depth boundaries, despite having low resolution. We refer to the appendices for a full slate of iBims-specific metrics. To evaluate high-frequency structures encountered in natural images (such as hair or fur), we use AM-2k (Li et al., [2022a](https://arxiv.org/html/2410.02073v1#bib.bib56)) and P3M-10k (Li et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib55)), which are high-resolution image matting datasets that were used to evaluate image matting models (Li et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib57)). Additionally, we further report results on the DIS-5k (Qin et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib77)) image segmentation dataset. This is an object segmentation dataset that provides highly accurate binary masks across diverse images. We manually remove samples in which the segmented object is occluded by foreground objects. Fig. [2](https://arxiv.org/html/2410.02073v1#S1.F2 "Figure 2 ‣ 1 Introduction ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") visually summarizes the boundary recall metric on the AM-2k dataset, as a function of runtime.

We find that Depth Pro produces more accurate boundaries than all baselines on all datasets, by a significant margin. As can be observed in Fig. [1](https://arxiv.org/html/2410.02073v1#S1.F1 "Figure 1 ‣ 1 Introduction ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second"), in the images in Tab. [2](https://arxiv.org/html/2410.02073v1#S4.T2 "Table 2 ‣ 4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second"), and the additional results in Sec. [A](https://arxiv.org/html/2410.02073v1#A1 "Appendix A Additional Results ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second"), the competitive metric accuracy of the recent Metric3D v2 and Depth Anything v2 models does not imply sharp boundaries. Depth Pro has a consistently higher recall for thin structures like hair and fur and yields sharper boundaries. This is also true in comparison to the diffusion-based Marigold, which leverages a prior trained on billions of real-word images, as well as PatchFusion, which operates at variable resolution. Note that the runtime of Depth Pro is orders of magnitude faster than Marigold and PatchFusion (see Fig. [2](https://arxiv.org/html/2410.02073v1#S1.F2 "Figure 2 ‣ 1 Introduction ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") & Tab. [5](https://arxiv.org/html/2410.02073v1#A1.T5 "Table 5 ‣ A.3 Runtime ‣ Appendix A Additional Results ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second")). Fig. [4](https://arxiv.org/html/2410.02073v1#S4.F4 "Figure 4 ‣ 4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") demonstrates the benefits of sharp boundary prediction for novel view synthesis from a single image.

Figure 4: Impact on novel view synthesis. We plug depth maps produced by Depth Pro, Marigold (Ke et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib45)), Depth Anything v2 (Yang et al., [2024b](https://arxiv.org/html/2410.02073v1#bib.bib113)), and Metric3D v2 (Hu et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib38)) into a recent publicly available novel view synthesis system (Khan et al., [2023](https://arxiv.org/html/2410.02073v1#bib.bib46)). We demonstrate results on images from AM-2k (Li et al., [2022a](https://arxiv.org/html/2410.02073v1#bib.bib56)) (1st & 3rd column) and DIS-5k (Qin et al., [2022](https://arxiv.org/html/2410.02073v1#bib.bib77)) (2nd column). Depth Pro produces sharper and more accurate depth maps, yielding cleaner synthesized views. Depth Anything v2 and Metric3D v2 suffer from misalignment between the input images and estimated depth maps, resulting in foreground pixels bleeding into the background. Marigold is considerably slower than Depth Pro and produces less accurate boundaries, yielding artifacts in synthesized images. Zoom in for detail.

Focal length estimation. Previous work (Piccinelli et al., [2024](https://arxiv.org/html/2410.02073v1#bib.bib76); Kocabas et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib49); Baradad & Torralba, [2020](https://arxiv.org/html/2410.02073v1#bib.bib2)) does not provide comprehensive systematic evaluations of focal length estimators on in-the-wild images. To address this, we curated a _zero-shot_ test dataset. To this end, we selected diverse datasets with intact EXIF data, enabling reliable assessment of focal length estimation accuracy. FiveK (Bychkovsky et al., [2011](https://arxiv.org/html/2410.02073v1#bib.bib10)), DDDP (Abuolaim & Brown, [2020](https://arxiv.org/html/2410.02073v1#bib.bib1)), and RAISE (Dang-Nguyen et al., [2015](https://arxiv.org/html/2410.02073v1#bib.bib18)) contribute professional-grade photographs taken with SLR cameras. SPAQ (Fang et al., [2020](https://arxiv.org/html/2410.02073v1#bib.bib28)) provides casual photographs from mobile phones. PPR10K (Liang et al., [2021](https://arxiv.org/html/2410.02073v1#bib.bib63)) provides high-quality portrait images. Finally, ZOOM (Zhang et al., [2019](https://arxiv.org/html/2410.02073v1#bib.bib122)) includes sets of scenes captured at various optical zoom levels.

Table 3: Comparison on focal length estimation. We report δ25%subscript𝛿percent25\\delta\_{25\\%}italic\_δ start\_POSTSUBSCRIPT 25 % end\_POSTSUBSCRIPT and δ50%subscript𝛿percent50\\delta\_{50\\%}italic\_δ start\_POSTSUBSCRIPT 50 % end\_POSTSUBSCRIPT for each dataset, i.e., the percentage of images with relative error (focal length in mm) less than 25% and 50%, respectively.

Tab. [3](https://arxiv.org/html/2410.02073v1#S4.T3 "Table 3 ‣ 4 Experiments ‣ Depth Pro: Sharp Monocular Metric Depth in Less Than a Second") compares Depth Pro against state-of-the-art focal length estimators and shows the percentage of images with relative estimation error under 25% and 50%, respectively. Depth Pro is the most accurate across all datasets. For example, on PPR10K, a dataset of human portraits, our method leads with 64.6% of the images having a focal length error below 25%, while the second-best method, SPEC, only achieves 34.6% on this metric. We attribute this superior performance to our network design and training protocol, which decouple training of the focal length estimator from the depth network, enabling us to use different training sets for these two tasks. Further controlled experiments are reported in the appendices.

## 5 Conclusion & limitations

Depth Pro produces high-resolution metric depth maps with high-frequency detail at sub-second runtimes. Our model achieves state-of-the-art zero-shot metric depth estimation accuracy without requiring metadata such as camera intrinsics, and traces out occlusion boundaries in unprecedented detail, facilitating applications such as novel view synthesis from single images ‘in the wild’. While Depth Pro outperforms prior work along multiple dimensions, it is not without limitations. For example, the model is limited in dealing with translucent surfaces and volumetric scattering, where the definition of single pixel depth is ill-posed and ambiguous.

